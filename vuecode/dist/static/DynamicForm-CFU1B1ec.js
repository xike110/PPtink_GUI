import{r as L,g as O,a as B,s as ae}from"./webdemo-CPAp8o33.js";/* empty css                    */import{_ as J,r as I,w as H,o as W,b as u,g as z,x as n,e as g,t as y,m as b,aa as le,ak as oe,d as S,f as p,A as x,C as Q,F as T,l as U,an as ie,ao as ce,ab as de,ac as me,z as se,p as D,ap as ue,B as re,aq as ve,ar as fe,af as he,as as we,at as be,N as ye,R as ge,c as K,au as pe,i as xe,av as ke,y as Ve,al as C,s as j}from"./zh-cn-Vbf23Fjh.js";const ze={class:"item-left"},Ee={class:"item-label"},$e={class:"item-description"},Ie={class:"item-right"},Ce={key:4},Te={key:0,class:"file-path"},Ue={class:"path-value"},Pe={key:5},Se={key:0,class:"file-path"},Me={key:6},De={key:0,class:"file-path"},Fe={class:"path-value"},Le={key:7},Ae={key:0,class:"file-path"},Ne={class:"path-value"},Re={key:0,class:"el-upload__tip"},Ye={key:19,class:"unsupported-type"},Ge={key:0,class:"error-message"},Be={key:1,class:"item-divider"},He={__name:"ComponentRenderer",props:{component:{type:Object,required:!0},modelValue:{type:[String,Number,Boolean,Array,Object],default:null},isLastComponent:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{expose:R,emit:k}){const v=e,V=k,t=I(v.modelValue),f=I(""),$=I(!1),A=async()=>{if(v.component.validate)try{if(console.log(`验证组件: ${v.component.name}, 值: ${t.value}, 验证方法: ${v.component.validate}`),!window.pywebview||!window.pywebview.api)return console.error("验证失败: pywebview API 未初始化"),f.value="API未初始化，无法验证",c(),!1;if(!window.pywebview.api[v.component.validate])return console.error(`验证失败: 方法 ${v.component.validate} 不存在于 API 中`),f.value=`验证方法 ${v.component.validate} 不存在`,c(),!1;console.log(`调用验证方法: window.pywebview.api.${v.component.validate}("${v.component.name}", ${JSON.stringify(t.value)})`);const l=await window.pywebview.api[v.component.validate](v.component.name,t.value);return console.log(`验证结果: ${l}`),l===!0?(f.value="",!0):(f.value=l,c(),!1)}catch(l){return console.error(`验证出错: ${l}`),f.value=`验证过程出错: ${l.message||l}`,c(),!1}return!0},c=()=>{$.value=!0,setTimeout(()=>{$.value=!1},500)},M=async()=>{try{const l=await window.pywebview.api.open_file_dialog();l&&l!=="未选择文件"&&(t.value=l,V("update:modelValue",l))}catch(l){console.error("选择文件出错:",l)}},E=async()=>{try{const l=await window.pywebview.api.open_multiple_files_dialog();l&&Array.isArray(l)&&l.length>0&&(t.value=l,V("update:modelValue",l))}catch(l){console.error("选择多文件出错:",l)}},Y=async()=>{try{const l=await window.pywebview.api.open_directory_dialog();l&&l!=="未选择目录"&&(t.value=l,V("update:modelValue",l))}catch(l){console.error("选择目录出错:",l)}},N=async()=>{try{const l=await window.pywebview.api.save_file_dialog();l&&l!=="未选择保存位置"&&(t.value=l,V("update:modelValue",l))}catch(l){console.error("选择保存位置出错:",l)}};return H(()=>v.modelValue,l=>{l!==t.value&&(t.value=l)}),H(t,l=>{V("update:modelValue",l),f.value=""}),R({validate:A}),W(()=>{v.modelValue!==void 0?t.value=v.modelValue:v.component.default!==void 0&&(t.value=v.component.default,V("update:modelValue",v.component.default))}),(l,o)=>{const P=le,i=oe,d=Q,h=ie,r=ce,w=de,m=me,s=se,G=ue,F=re,X=ve,Z=fe,_=he,ee=we,te=be;return e.component.visible!==!1?(n(),u("div",{key:0,class:D(["component-container",{"full-width":e.component.full_width}])},[g("div",{class:D(["component-item",{"shake-animation":$.value}])},[g("div",ze,[g("span",Ee,y(e.component.title),1),g("div",$e,y(e.component.help),1)]),g("div",Ie,[e.component.type==="text"?(n(),b(P,{key:0,modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=a=>t.value=a),spellcheck:"false",placeholder:e.component.placeholder||`请输入${e.component.title}`,size:e.component.size||"large",maxlength:e.component.maxlength,minlength:e.component.minlength,readonly:e.component.readonly,disabled:e.component.disabled,clearable:e.component.clearable!==!1,"show-word-limit":e.component.showWordLimit,"prefix-icon":e.component.prefixIcon,"suffix-icon":e.component.suffixIcon,type:e.component.inputType||"text",autocomplete:e.component.autocomplete,"validate-event":e.component.validateEvent!==!1,"input-style":e.component.inputStyle,resize:e.component.resize},null,8,["modelValue","placeholder","size","maxlength","minlength","readonly","disabled","clearable","show-word-limit","prefix-icon","suffix-icon","type","autocomplete","validate-event","input-style","resize"])):e.component.type==="password"?(n(),b(P,{key:1,modelValue:t.value,"onUpdate:modelValue":o[1]||(o[1]=a=>t.value=a),type:"password",spellcheck:"false",placeholder:e.component.placeholder||`请输入${e.component.title}`,size:e.component.size||"large",maxlength:e.component.maxlength,minlength:e.component.minlength,readonly:e.component.readonly,disabled:e.component.disabled,clearable:e.component.clearable!==!1,"show-password":e.component.showPassword!==!1,"prefix-icon":e.component.prefixIcon,"suffix-icon":e.component.suffixIcon,autocomplete:e.component.autocomplete||"off","validate-event":e.component.validateEvent!==!1,"input-style":e.component.inputStyle},null,8,["modelValue","placeholder","size","maxlength","minlength","readonly","disabled","clearable","show-password","prefix-icon","suffix-icon","autocomplete","validate-event","input-style"])):e.component.type==="number"?(n(),b(i,{key:2,modelValue:t.value,"onUpdate:modelValue":o[2]||(o[2]=a=>t.value=a),spellcheck:"false",min:e.component.min!==void 0?e.component.min:-1/0,max:e.component.max!==void 0?e.component.max:1/0,size:e.component.size||"large",disabled:e.component.disabled,step:e.component.step||1,"step-strictly":e.component.stepStrictly,precision:e.component.precision,controls:e.component.controls!==!1,"controls-position":e.component.controlsPosition,placeholder:e.component.placeholder,label:e.component.inputLabel,"validate-event":e.component.validateEvent!==!1},null,8,["modelValue","min","max","size","disabled","step","step-strictly","precision","controls","controls-position","placeholder","label","validate-event"])):e.component.type==="textarea"?(n(),b(P,{key:3,modelValue:t.value,"onUpdate:modelValue":o[3]||(o[3]=a=>t.value=a),type:"textarea",spellcheck:"false",rows:e.component.rows||(e.component.height?Math.floor(e.component.height/20):3),placeholder:e.component.placeholder||`请输入${e.component.title}`,readonly:e.component.readonly,disabled:e.component.disabled,maxlength:e.component.maxlength,minlength:e.component.minlength,clearable:e.component.clearable!==!1,autosize:e.component.autosize,resize:e.component.resize||"vertical","show-word-limit":e.component.showWordLimit,"validate-event":e.component.validateEvent!==!1,"input-style":e.component.inputStyle},null,8,["modelValue","rows","placeholder","readonly","disabled","maxlength","minlength","clearable","autosize","resize","show-word-limit","validate-event","input-style"])):e.component.type==="file"?(n(),u("div",Ce,[S(d,{type:"primary",onClick:M,plain:e.component.plain!==!1,size:e.component.size||"default",disabled:e.component.disabled,icon:e.component.buttonIcon},{default:p(()=>[x(y(e.component.buttonText||"选择文件"),1)]),_:1},8,["plain","size","disabled","icon"]),t.value?(n(),u("div",Te,[o[14]||(o[14]=x(" 已选择: ")),g("span",Ue,y(t.value),1)])):z("",!0)])):e.component.type==="multifile"?(n(),u("div",Pe,[S(d,{type:"primary",onClick:E,plain:e.component.plain!==!1,size:e.component.size||"default",disabled:e.component.disabled,icon:e.component.buttonIcon},{default:p(()=>[x(y(e.component.buttonText||"选择多个文件"),1)]),_:1},8,["plain","size","disabled","icon"]),t.value&&t.value.length?(n(),u("div",Se,[x(" 已选择 "+y(Array.isArray(t.value)?t.value.length:0)+" 个文件 ",1),(n(!0),u(T,null,U(t.value,(a,ne)=>(n(),u("div",{key:ne,class:"path-item"},y(a),1))),128))])):z("",!0)])):e.component.type==="directory"?(n(),u("div",Me,[S(d,{type:"primary",onClick:Y,plain:e.component.plain!==!1,size:e.component.size||"default",disabled:e.component.disabled,icon:e.component.buttonIcon},{default:p(()=>[x(y(e.component.buttonText||"选择目录"),1)]),_:1},8,["plain","size","disabled","icon"]),t.value?(n(),u("div",De,[o[15]||(o[15]=x(" 已选择: ")),g("span",Fe,y(t.value),1)])):z("",!0)])):e.component.type==="filesaver"?(n(),u("div",Le,[S(d,{type:"primary",onClick:N,plain:e.component.plain!==!1,size:e.component.size||"default",disabled:e.component.disabled,icon:e.component.buttonIcon},{default:p(()=>[x(y(e.component.buttonText||"选择保存位置"),1)]),_:1},8,["plain","size","disabled","icon"]),t.value?(n(),u("div",Ae,[o[16]||(o[16]=x(" 将保存至: ")),g("span",Ne,y(t.value),1)])):z("",!0)])):e.component.type==="date"?(n(),b(h,{key:8,modelValue:t.value,"onUpdate:modelValue":o[4]||(o[4]=a=>t.value=a),type:e.component.dateType||"date",placeholder:e.component.placeholder||`选择${e.component.title}`,format:e.component.format||"YYYY-MM-DD","value-format":e.component.valueFormat||"YYYY-MM-DD",size:e.component.size||"large",disabled:e.component.disabled,clearable:e.component.clearable!==!1,editable:e.component.editable!==!1,"start-placeholder":e.component.startPlaceholder,"end-placeholder":e.component.endPlaceholder,"range-separator":e.component.rangeSeparator||"至",shortcuts:e.component.shortcuts,"disabled-date":e.component.disabledDate,"validate-event":e.component.validateEvent!==!1},null,8,["modelValue","type","placeholder","format","value-format","size","disabled","clearable","editable","start-placeholder","end-placeholder","range-separator","shortcuts","disabled-date","validate-event"])):e.component.type==="time"?(n(),b(r,{key:9,modelValue:t.value,"onUpdate:modelValue":o[5]||(o[5]=a=>t.value=a),placeholder:e.component.placeholder||`选择${e.component.title}`,format:e.component.format||"HH:mm:ss","value-format":e.component.valueFormat||"HH:mm:ss",size:e.component.size||"large",disabled:e.component.disabled,clearable:e.component.clearable!==!1,editable:e.component.editable!==!1,"is-range":e.component.isRange,"arrow-control":e.component.arrowControl,"start-placeholder":e.component.startPlaceholder,"end-placeholder":e.component.endPlaceholder,"range-separator":e.component.rangeSeparator||"至","validate-event":e.component.validateEvent!==!1},null,8,["modelValue","placeholder","format","value-format","size","disabled","clearable","editable","is-range","arrow-control","start-placeholder","end-placeholder","range-separator","validate-event"])):e.component.type==="datetime"?(n(),b(h,{key:10,modelValue:t.value,"onUpdate:modelValue":o[6]||(o[6]=a=>t.value=a),type:e.component.dateTimeType||"datetime",placeholder:e.component.placeholder||`选择${e.component.title}`,format:e.component.format||"YYYY-MM-DD HH:mm:ss","value-format":e.component.valueFormat||"YYYY-MM-DD HH:mm:ss",size:e.component.size||"large",disabled:e.component.disabled,clearable:e.component.clearable!==!1,editable:e.component.editable!==!1,"start-placeholder":e.component.startPlaceholder,"end-placeholder":e.component.endPlaceholder,"range-separator":e.component.rangeSeparator||"至",shortcuts:e.component.shortcuts,"disabled-date":e.component.disabledDate,"disabled-time":e.component.disabledTime,"validate-event":e.component.validateEvent!==!1},null,8,["modelValue","type","placeholder","format","value-format","size","disabled","clearable","editable","start-placeholder","end-placeholder","range-separator","shortcuts","disabled-date","disabled-time","validate-event"])):e.component.type==="dropdown"?(n(),b(m,{key:11,modelValue:t.value,"onUpdate:modelValue":o[7]||(o[7]=a=>t.value=a),placeholder:e.component.placeholder||`请选择${e.component.title}`,style:{width:"100%"},size:e.component.size||"large",disabled:e.component.disabled,clearable:e.component.clearable!==!1,filterable:e.component.filterable,"filter-method":e.component.filterMethod,remote:e.component.remote,"remote-method":e.component.remoteMethod,loading:e.component.loading,"loading-text":e.component.loadingText||"加载中...","no-match-text":e.component.noMatchText||"无匹配数据","no-data-text":e.component.noDataText||"无数据","allow-create":e.component.allowCreate,"default-first-option":e.component.defaultFirstOption,"reserve-keyword":e.component.reserveKeyword!==!1,"value-key":e.component.valueKey||"value","validate-event":e.component.validateEvent!==!1},{default:p(()=>[(n(!0),u(T,null,U(e.component.options,a=>(n(),b(w,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","size","disabled","clearable","filterable","filter-method","remote","remote-method","loading","loading-text","no-match-text","no-data-text","allow-create","default-first-option","reserve-keyword","value-key","validate-event"])):e.component.type==="select"?(n(),b(m,{key:12,modelValue:t.value,"onUpdate:modelValue":o[8]||(o[8]=a=>t.value=a),placeholder:e.component.placeholder||`请选择${e.component.title}`,style:{width:"100%"},multiple:"",height:e.component.height||200,size:e.component.size||"large",disabled:e.component.disabled,clearable:e.component.clearable!==!1,filterable:e.component.filterable,"filter-method":e.component.filterMethod,remote:e.component.remote,"remote-method":e.component.remoteMethod,loading:e.component.loading,"loading-text":e.component.loadingText||"加载中...","no-match-text":e.component.noMatchText||"无匹配数据","no-data-text":e.component.noDataText||"无数据","allow-create":e.component.allowCreate,"default-first-option":e.component.defaultFirstOption,"collapse-tags":e.component.collapseTags,"collapse-tags-tooltip":e.component.collapseTagsTooltip,"multiple-limit":e.component.multipleLimit,"reserve-keyword":e.component.reserveKeyword!==!1,"value-key":e.component.valueKey||"value","validate-event":e.component.validateEvent!==!1},{default:p(()=>[(n(!0),u(T,null,U(e.component.options,a=>(n(),b(w,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","height","size","disabled","clearable","filterable","filter-method","remote","remote-method","loading","loading-text","no-match-text","no-data-text","allow-create","default-first-option","collapse-tags","collapse-tags-tooltip","multiple-limit","reserve-keyword","value-key","validate-event"])):e.component.type==="radio"?(n(),b(G,{key:13,modelValue:t.value,"onUpdate:modelValue":o[9]||(o[9]=a=>t.value=a),class:D(e.component.direction==="horizontal"?"radio-group-horizontal":"radio-group-vertical"),disabled:e.component.disabled,size:e.component.size,"text-color":e.component.textColor,fill:e.component.fill,"validate-event":e.component.validateEvent!==!1,label:e.component.groupLabel},{default:p(()=>[(n(!0),u(T,null,U(e.component.options,a=>(n(),b(s,{key:a.value,label:a.value},{default:p(()=>[x(y(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","class","disabled","size","text-color","fill","validate-event","label"])):e.component.type==="checkbox"?(n(),b(X,{key:14,modelValue:t.value,"onUpdate:modelValue":o[10]||(o[10]=a=>t.value=a),class:D(e.component.direction==="horizontal"?"checkbox-group-horizontal":"checkbox-group-vertical"),disabled:e.component.disabled,size:e.component.size,min:e.component.min,max:e.component.max,"text-color":e.component.textColor,fill:e.component.fill,"validate-event":e.component.validateEvent!==!1,label:e.component.groupLabel},{default:p(()=>[(n(!0),u(T,null,U(e.component.options,a=>(n(),b(F,{key:a.value,label:a.value},{default:p(()=>[x(y(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","class","disabled","size","min","max","text-color","fill","validate-event","label"])):e.component.type==="color"?(n(),b(Z,{key:15,modelValue:t.value,"onUpdate:modelValue":o[11]||(o[11]=a=>t.value=a),"show-alpha":e.component.showAlpha!==!1,disabled:e.component.disabled,size:e.component.size,predefine:e.component.predefine,"color-format":e.component.colorFormat,"popper-class":e.component.popperClass,"validate-event":e.component.validateEvent!==!1},null,8,["modelValue","show-alpha","disabled","size","predefine","color-format","popper-class","validate-event"])):e.component.type==="switch"?(n(),b(_,{key:16,modelValue:t.value,"onUpdate:modelValue":o[12]||(o[12]=a=>t.value=a),"active-text":e.component.activeText||"开启","inactive-text":e.component.inactiveText||"关闭",size:e.component.size||"large",width:e.component.width,"inline-prompt":e.component.inlinePrompt,"active-icon":e.component.activeIcon,"inactive-icon":e.component.inactiveIcon,"active-color":e.component.activeColor,"inactive-color":e.component.inactiveColor,"border-color":e.component.borderColor,disabled:e.component.disabled,loading:e.component.loading,"active-value":e.component.activeValue,"inactive-value":e.component.inactiveValue,"before-change":e.component.beforeChange,"validate-event":e.component.validateEvent!==!1},null,8,["modelValue","active-text","inactive-text","size","width","inline-prompt","active-icon","inactive-icon","active-color","inactive-color","border-color","disabled","loading","active-value","inactive-value","before-change","validate-event"])):e.component.type==="slider"?(n(),b(ee,{key:17,modelValue:t.value,"onUpdate:modelValue":o[13]||(o[13]=a=>t.value=a),min:e.component.min!==void 0?e.component.min:0,max:e.component.max!==void 0?e.component.max:100,disabled:e.component.disabled,step:e.component.step||1,"show-input":e.component.showInput!==!1,"show-input-controls":e.component.showInputControls!==!1,"input-size":e.component.inputSize||"small","show-stops":e.component.showStops,"show-tooltip":e.component.showTooltip!==!1,"format-tooltip":e.component.formatTooltip,range:e.component.range,vertical:e.component.vertical,height:e.component.height,label:e.component.label,"range-start-label":e.component.rangeStartLabel,"range-end-label":e.component.rangeEndLabel,"format-value-text":e.component.formatValueText,"validate-event":e.component.validateEvent!==!1,marks:e.component.marks},null,8,["modelValue","min","max","disabled","step","show-input","show-input-controls","input-size","show-stops","show-tooltip","format-tooltip","range","vertical","height","label","range-start-label","range-end-label","format-value-text","validate-event","marks"])):e.component.type==="upload"?(n(),b(te,{key:18,action:e.component.action,headers:e.component.headers,method:e.component.method||"post",data:e.component.data,name:e.component.name,"with-credentials":e.component.withCredentials,"show-file-list":e.component.showFileList!==!1,accept:e.component.accept,multiple:e.component.multiple,limit:e.component.limit,disabled:e.component.disabled,drag:e.component.drag,"auto-upload":e.component.autoUpload!==!1,"file-list":e.component.fileList||t.value||[],"list-type":e.component.listType||"text"},{tip:p(()=>[e.component.tip?(n(),u("div",Re,y(e.component.tip),1)):z("",!0)]),default:p(()=>[S(d,{type:"primary"},{default:p(()=>[x(y(e.component.buttonText||"点击上传"),1)]),_:1})]),_:1},8,["action","headers","method","data","name","with-credentials","show-file-list","accept","multiple","limit","disabled","drag","auto-upload","file-list","list-type"])):(n(),u("div",Ye," 不支持的组件类型: "+y(e.component.type),1))])],2),f.value?(n(),u("div",Ge,y(f.value),1)):z("",!0),e.isLastComponent?z("",!0):(n(),u("div",Be))],2)):z("",!0)}}},q=J(He,[["__scopeId","data-v-e0340a67"]]),Oe={class:"dynamic-form-container","element-loading-text":"正在加载数据参数..."},Ke={class:"form-content"},je={key:0,class:"settings-panel"},qe={key:0,class:"form-header"},Je={class:"form-title"},We={class:"form-description"},Qe={class:"panel-content"},Xe={class:"panel-header"},Ze={key:0,class:"panel-description"},_e={class:"action-buttons"},et={__name:"DynamicForm",setup(e){const R=ye(),k=I({}),v=I(!0),V=I({}),t=ge("pywebviewReady",I(!1)),f=I(null),$=I(0),A=K(()=>L.value),c=K(()=>!f.value||!f.value.menus||f.value.menus.length===0?null:f.value.menus[$.value]),M=async()=>{if(typeof window>"u"||!window.pywebview||!window.pywebview.api||!window.pywebview.api.get_gui_config){console.warn("pywebview API未就绪或缺少所需方法，无法加载GUI配置"),C.warning("应用接口尚未准备好，部分功能可能不可用"),f.value||(f.value={menus:[{name:"示例菜单",help:"API未就绪，显示默认UI",components:[{name:"demo_input",title:"示例输入",type:"text",default:"这是默认配置(API未就绪)"}]}]},E(),v.value=!1);return}try{const i=new Promise((h,r)=>setTimeout(()=>r(new Error("获取GUI配置超时")),5e3)),d=await Promise.race([window.pywebview.api.get_gui_config(),i]);f.value=d,E(),console.log("加载GUI配置成功:",d)}catch(i){console.error("加载GUI配置失败:",i),C.error("加载表单配置失败，请重试"),f.value||(f.value={menus:[{name:"配置加载失败",help:"请刷新页面重试",components:[{name:"error_message",title:"错误信息",type:"text",default:"无法加载表单配置，请刷新页面",readonly:!0}]}]},E())}finally{v.value=!1}},E=()=>{if(!f.value||!f.value.menus)return;const i={};f.value.menus.forEach(d=>{d.components&&d.components.forEach(h=>{h.default!==void 0&&(i[h.name]=h.default)}),d.groups&&d.groups.forEach(h=>{h.components&&h.components.forEach(r=>{r.default!==void 0&&(i[r.name]=r.default)})})}),k.value=i,console.log("初始化表单数据:",k.value)},Y=()=>{c.value&&(E(),C.success("表单已重置"))},N=(i,d)=>{i&&(V.value[d]=i,console.log(`组件引用已保存: ${d}`))},l=async()=>{if(typeof window>"u"||!window.pywebview||!window.pywebview.api){C.warning("应用接口尚未准备好，无法提交表单"),console.warn("pywebview API 未就绪，无法提交表单");return}try{const i=await O();if(i){C.warning("任务正在运行中，请先停止");return}L.value!==i&&(L.value=i);let d=!0;const h=[];c.value&&c.value.components&&c.value.components.forEach(m=>{m.validate&&V.value[m.name]?(h.push(V.value[m.name]),console.log(`添加验证组件: ${m.name}, 验证方法: ${m.validate}`)):m.validate&&console.warn(`组件 ${m.name} 需要验证但未找到组件引用`)}),c.value&&c.value.groups&&c.value.groups.forEach(m=>{m.components&&m.components.forEach(s=>{s.validate&&V.value[s.name]?(h.push(V.value[s.name]),console.log(`添加验证组件: ${s.name}, 验证方法: ${s.validate}`)):s.validate&&console.warn(`组件 ${s.name} 需要验证但未找到组件引用`)})}),console.log(`收集到 ${h.length} 个需要验证的组件`);for(const m of h)try{console.log("正在验证组件...");const s=await m.validate();console.log(`验证结果: ${s}`),s||(d=!1)}catch(s){console.error("验证组件时出错:",s),d=!1}if(!d){C.error("表单验证失败，请检查输入");return}const r={};c.value&&(c.value.components&&c.value.components.forEach(m=>{m.name in k.value&&(r[m.name]=k.value[m.name])}),c.value.groups&&c.value.groups.forEach(m=>{m.components&&m.components.forEach(s=>{s.name in k.value&&(r[s.name]=k.value[s.name])})})),console.log("提交表单数据(已过滤):",r);const w={gui_name:B.value.GUI_NAME,sign:B.value.SIGN,main:B.value.MAIN,menuName:c.value?c.value.name:"未知菜单",formData:r};sessionStorage.setItem("runParams",JSON.stringify(w)),ae.value=!0,R.push("/webdemo-log")}catch(i){console.error("提交表单时发生错误:",i),C.error("提交表单时发生错误，请稍后重试")}},o=()=>{A.value&&C.warning("请先停止运行！")};H(f,i=>{i&&(E(),v.value=!1)},{deep:!0});const P=()=>{const i=window.location.hash,h=new URLSearchParams(window.location.hash.split("?")[1]).get("menuIndex");if(h!==null)try{const r=parseInt(h,10);isNaN(r)||(console.log(`菜单切换(查询参数): ${$.value} -> ${r}`),$.value=r,j(()=>{console.log("重新加载表单数据..."),!f.value&&window.pywebview&&window.pywebview.api?M().then(()=>E()):E()}))}catch(r){console.error("解析查询参数菜单索引失败:",r)}else if(i.includes("dynamic-"))try{const r=i.match(/dynamic-(\d+)/);if(r&&r[1]){const w=parseInt(r[1],10);isNaN(w)||(console.log(`菜单切换(URL路径): ${$.value} -> ${w}`),$.value=w,j(()=>{console.log("重新加载表单数据..."),!f.value&&window.pywebview&&window.pywebview.api?M().then(()=>E()):E()}))}}catch(r){console.error("解析路径菜单索引失败:",r)}};return W(async()=>{try{v.value=!0,await O().then(i=>{i||(L.value=!1)}).catch(i=>{console.warn("获取运行状态失败，使用默认值(false):",i),L.value=!1}),t.value&&window.pywebview&&window.pywebview.api?(console.log("pywebview API已就绪，开始加载GUI配置"),await M()):(console.log("等待pywebview API就绪..."),window.addEventListener("pywebviewready",()=>{console.log("pywebviewready事件触发，开始加载GUI配置"),setTimeout(()=>M(),500)})),P(),window.addEventListener("hashchange",P)}catch(i){console.error("组件挂载时出错:",i),v.value=!1}}),pe(()=>{window.removeEventListener("hashchange",P)}),(i,d)=>{const h=Q,r=ke;return xe((n(),u("div",Oe,[g("div",Ke,[c.value&&c.value.components&&c.value.components.length>0?(n(),u("div",je,[c.value?(n(),u("div",qe,[g("div",Je,[g("h2",null,y(c.value.name),1),g("div",We,y(c.value.help),1)])])):z("",!0),d[0]||(d[0]=g("div",{class:"item-divider"},null,-1)),g("div",Qe,[(n(!0),u(T,null,U(c.value.components,(w,m)=>(n(),b(q,{key:m,component:w,modelValue:k.value[w.name],"onUpdate:modelValue":s=>k.value[w.name]=s,ref_for:!0,ref:s=>N(s,w.name)},null,8,["component","modelValue","onUpdate:modelValue"]))),128))])])):z("",!0),c.value&&c.value.groups?(n(!0),u(T,{key:1},U(c.value.groups,(w,m)=>(n(),u("div",{key:m,class:D(["settings-panel",{"with-border":w.show_border}])},[g("div",Xe,y(w.title),1),w.description?(n(),u("div",Ze,y(w.description),1)):z("",!0),g("div",{class:D(["panel-content",{"multi-column":w.columns>1}]),style:Ve({"grid-template-columns":`repeat(${w.columns}, 1fr)`})},[(n(!0),u(T,null,U(w.components,(s,G)=>(n(),b(q,{key:`${m}-${G}`,component:s,modelValue:k.value[s.name],"onUpdate:modelValue":F=>k.value[s.name]=F,ref_for:!0,ref:F=>N(F,s.name)},null,8,["component","modelValue","onUpdate:modelValue"]))),128))],6)],2))),128)):z("",!0)]),g("div",_e,[S(h,{type:"info",onClick:Y,plain:""},{default:p(()=>d[1]||(d[1]=[x("重置表单")])),_:1}),S(h,{type:"success",onClick:l,disabled:A.value,onMouseenter:o},{default:p(()=>d[2]||(d[2]=[x("开始运行")])),_:1},8,["disabled"])])])),[[r,v.value,void 0,{fullscreen:!0,lock:!0}]])}}},lt=J(et,[["__scopeId","data-v-5ff5b5c0"]]);export{lt as default};
